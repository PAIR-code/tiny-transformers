@let exp = experiment(); @if( exp === null) {
<div>
  <button mat-button (click)="newExperiment()">New experiment</button>
  <button mat-button (click)="loadExperiment()">Load</button>
  @if(error) {
  <div class="error">
    <div class="buttons">
      <div class="spacer"></div>
      <button mat-button (click)="clearError()">X</button>
    </div>
    <div class="errorMessage">{{ error }}</div>
  </div>
  }
</div>
} @else { @let sections = exp.sections();

<div clas="page">
  <div class="header hoverButtons">
    <div class="path">{{ exp.id }}</div>
    <div class="buttons">
      <div class="spacer"></div>
      <button
        mat-icon-button
        matTooltip=""
        [matMenuTriggerFor]="experimentMenu"
      >
        <mat-icon>...</mat-icon>
        <mat-menu #experimentMenu class="vmenu">
          <div>
            <button mat-button matTooltip="Save" (click)="saveExperiment(exp)">
              save
            </button>
          </div>
          <div>
            <button mat-button matTooltip="Close" (click)="closeExperiment()">
              close
            </button>
          </div>
        </mat-menu>
      </button>
    </div>
  </div>

  <mat-sidenav-container>
    <mat-sidenav #sidenav mode="side" opened="true">
      <mat-nav-list class="menu-buttons">
        @for (section of sections; track section.def.id) {
        <mat-list-item
          [activated]="router.url == '#'"
          matListItemTitle
          routerLink=""
          routerLinkActive="active"
          ariaCurrentWhenActive="sections"
        >
          {{ section.def.id }}
        </mat-list-item>
        }
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content>
      <div class="sections hoverButtons">
        @for (section of sections; track section.def.id) { @let data =
        section.data();
        <div class="section">
          <mat-card>
            <mat-card-content>
              @if(data.kind === ExpDefKind.Data) {
              @if(data.sectionData.sectionKind === SectionKind.Markdown) {
              <div>{{ data.sectionData.markdown }}</div>
              } @else {
              <div>
                Unknown sectionDataKind {{ data.sectionData.sectionKind }}
              </div>
              } } @else {
              <div>Unknown data.kind {{ data.kind }}</div>
              }
            </mat-card-content>
          </mat-card>
          <div class="buttons">
            <button mat-button>+</button>
            <span class="'spacer"></span>
            <button mat-button>...</button>
          </div>
        </div>
        }
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
}
